{
  
    
        "post0": {
            "title": "Covid-19 predictor using posteroanterior (PA) chest X-ray images",
            "content": "The X-ray dataset is taken from - https://github.com/ieee8023/covid-chestxray-dataset. . I have been running this code on Google Colab environment using a GPU as a hardware accelerator. Since the notebook is using Resnet50 for transfer learning you will need a machine with an NVIDIA GPU otherwise the training might take ages . The folder structure I am using here to store the images is - Covid/ -| covid_positive -| covid_negative -| metadata.csv (This can be downloaded from the open source database) . Fast AI makes it extremely simple if you make a folder for each of your class and put all the respective images in that folder . . Important: Pay attention! This notebook by no means is an accurate model to predict covid-19 or make any kind of diagnosis whatsoever. This is an ongoing experiment being done using opensource databases just as a POC. The model is not suitable for deployment.* . from fastai.vision import * from fastai.widgets import * import pandas as pd . Mount Google Drive with path to folders containing images. You need to change this path to point to the folder which contains the x-ray images . drive_path = &#39;drive/My Drive/FastAI/Covid/&#39; . df = pd.read_csv(drive_path+&#39;metadata.csv&#39;) . covid_positive = df[&#39;finding&#39;] == &#39;COVID-19&#39; . xrays = df[&#39;modality&#39;] == &#39;X-ray&#39; CT = df[&#39;modality&#39;] == &#39;CT&#39; PA = df[&#39;view&#39;] == &#39;PA&#39; AP = df[&#39;view&#39;] == &#39;AP&#39; . I have cloned the image repository to my local machine. Since I am running this notebook on Colab I have to run a script on my local machine to upload the covid_postive and covid_negative images to my google drive. . PA_covid and PA_non_covid gives me the list of file names which are then uploaded to google drive . PA_covid = df[covid_positive &amp; PA ] PA_non_covid = df[PA &amp; ~covid_positive] . #List files belonging to both the classes covid_images = [files for files in PA_covid[&#39;filename&#39;]] non_covid_images = [files for files in PA_non_covid[&#39;filename&#39;]] . path = Path(drive_path) . classes = [&#39;covid_positive&#39;, &#39;covid_negative&#39;] . #sanity check images for c in classes: verify_images(path/c) . #Split data into train and validation sets data = ImageDataBunch.from_folder(path, train=&quot;.&quot;, test=&#39;test&#39;, valid_pct=0.25, ds_tfms=get_transforms(), bs=8, size=512, num_workers=4).normalize(imagenet_stats) . #View data data.show_batch(rows=3, figsize=(7,8)) . Training . We are using a Resnet50 for transfer learning. Using fit one cycle for a few epochs and then using fastai&#39;s lrfinder to find an optimal range for our learning rate. . We use precision and recall to measure the incidents of false positives and false negatives. . precision=Precision() recall=Recall() AUC=AUROC() . learn = cnn_learner(data, models.resnet50, metrics=(accuracy, precision, recall, AUC)) . learn.fit_one_cycle(1) . epoch train_loss valid_loss accuracy precision recall auroc time . 0 | 1.356049 | 1.467854 | 0.632653 | 0.642857 | 0.409091 | 0.816498 | 00:14 | . learn.fit_one_cycle(3) learn.recorder.plot_losses() . epoch train_loss valid_loss accuracy precision recall auroc time . 0 | 0.780940 | 0.582251 | 0.775510 | 0.789474 | 0.681818 | 0.917508 | 00:14 | . 1 | 0.930111 | 1.348126 | 0.673469 | 0.800000 | 0.363636 | 0.771044 | 00:14 | . 2 | 0.696235 | 0.713986 | 0.795918 | 0.875000 | 0.636364 | 0.883838 | 00:15 | . learn.save(&#39;stage-1&#39;) . Use lr_find() to choose learning rate . learn.lr_find() learn.recorder.plot() . &lt;progress value=&#39;4&#39; class=&#39;&#39; max=&#39;6&#39;, style=&#39;width:300px; height:20px; vertical-align: middle;&#39;&gt;&lt;/progress&gt; 66.67% [4/6 00:45&lt;00:22] epoch train_loss valid_loss accuracy precision recall auroc time . 0 | 0.396417 | #na# | 00:11 | . 1 | 0.603173 | #na# | 00:11 | . 2 | 0.485660 | #na# | 00:11 | . 3 | 0.475031 | #na# | 00:11 | . &lt;progress value=&#39;8&#39; class=&#39;&#39; max=&#39;18&#39;, style=&#39;width:300px; height:20px; vertical-align: middle;&#39;&gt;&lt;/progress&gt; 44.44% [8/18 00:06&lt;00:08 0.8336] &lt;/div&gt; &lt;/div&gt; LR Finder is complete, type {learner_name}.recorder.plot() to see the graph. . &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; learn.unfreeze() . learn.fit_one_cycle(5, max_lr=slice(1e-6,3e-6)) learn.recorder.plot_losses() . epoch train_loss valid_loss accuracy precision recall auroc time . 0 | 0.366462 | 0.797330 | 0.795918 | 0.875000 | 0.636364 | 0.883838 | 00:15 | . 1 | 0.415618 | 0.675390 | 0.775510 | 0.823529 | 0.636364 | 0.885522 | 00:14 | . 2 | 0.346195 | 0.851609 | 0.714286 | 0.900000 | 0.409091 | 0.882155 | 00:15 | . 3 | 0.389726 | 0.791412 | 0.775510 | 0.923077 | 0.545455 | 0.888889 | 00:15 | . 4 | 0.353896 | 0.615626 | 0.755102 | 0.750000 | 0.681818 | 0.893939 | 00:15 | . learn.save(&#39;stage-2&#39;) . interp = ClassificationInterpretation.from_learner(learn) interp.plot_confusion_matrix() . interp.plot_top_losses(4) . preds, y, losses = learn.get_preds(ds_type=DatasetType.Test, with_loss=True) . &lt;/div&gt; .",
            "url": "https://prateekkarkare.github.io/fastpages/deeplearning/fastai/jupyter/2020/04/08/covid_predictor.html",
            "relUrl": "/deeplearning/fastai/jupyter/2020/04/08/covid_predictor.html",
            "date": " • Apr 8, 2020"
        }
        
    
  

  
  

  
      ,"page1": {
          "title": "About Me",
          "content": "I am a machine learning enthusiast and with a special interest in image recognition. . Someone who enjoys learning for the sake of it, I get high on good music and great jam sessions, playing and collecting different musical instruments, electronics, react.js, Node.js, Unity VR development and of course machine learning. . I regularly write on medium about basic concepts in Machine Leanring visit: https://medium.com/@prateekkarkare . If you have suggestions to good music, great learning material on any of the above feel free to drop me a DM on twitter, linkedin or any of the blog posts here! .",
          "url": "https://prateekkarkare.github.io/fastpages/about/",
          "relUrl": "/about/",
          "date": ""
      }
      
  

  

  
  

  

  
  

  

  
  

  
  

  
  

  
      ,"page10": {
          "title": "",
          "content": "Sitemap: {{ “sitemap.xml” | absolute_url }} | .",
          "url": "https://prateekkarkare.github.io/fastpages/robots.txt",
          "relUrl": "/robots.txt",
          "date": ""
      }
      
  

}